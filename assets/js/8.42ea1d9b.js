(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{176:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",[t._v("Common Networks")]),a("h2",{attrs:{id:"cnn-mnist"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cnn-mnist","aria-hidden":"true"}},[t._v("#")]),t._v(" CNN (MNIST)")]),a("blockquote",[a("p",[t._v("Setup")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tensorflow"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("examples"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tutorials"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mnist "),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" input_data\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" tensorflow "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" tf\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" numpy "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" np\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" matplotlib"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pyplot "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" plt\n\ntf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_random_seed"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nnp"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seed"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("blockquote",[a("p",[t._v("Prepare Input")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("BATCH_SIZE "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("50")]),t._v("\nLR "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0.001")]),t._v("  "),a("span",{attrs:{class:"token comment"}},[t._v("# learning rate")]),t._v("\n\nmnist "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" input_data"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read_data_sets"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'./mnist'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" one_hot"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("True")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest_x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("images"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("2000")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# use only 2000 images for testing")]),t._v("\ntest_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("labels"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("2000")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\ntf_x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \ntf_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("int32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("10")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntf_x "),a("span",{attrs:{class:"token operator"}},[t._v("/=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("255")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# normalize image pixels (pixels' max value is 255)")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# (batch, height, width, channel)")]),t._v("\nimages "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("blockquote",[a("p",[t._v("CNN")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("conv1 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conv2d"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("   "),a("span",{attrs:{class:"token comment"}},[t._v("# shape (28, 28, 1)")]),t._v("\n    inputs"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("images"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    filters"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token number"}},[t._v("16")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    kernel_size"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token number"}},[t._v("5")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    strides"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    padding"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("'same'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    activation"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("relu\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# -> (28, 28, 16)")]),t._v("\npool1 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max_pooling2d"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    conv1"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    pool_size"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    strides"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# -> (14, 14, 16)")]),t._v("\nconv2 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conv2d"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pool1"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("32")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("5")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'same'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                         activation"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("relu"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# -> (14, 14, 32)")]),t._v("\npool2 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max_pooling2d"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("conv2"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),a("span",{attrs:{class:"token comment"}},[t._v("# -> (7, 7, 32)")]),t._v("\nflat "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pool2"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("7")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token number"}},[t._v("7")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token number"}},[t._v("32")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("          "),a("span",{attrs:{class:"token comment"}},[t._v("# -> (7*7*32, )")]),t._v("\noutput "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flat"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("10")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("              "),a("span",{attrs:{class:"token comment"}},[t._v("# output layer")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("blockquote",[a("p",[t._v("Loss / Training Ops")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("loss = tf.losses.softmax_cross_entropy(onehot_labels=tf_y, logits=output)\ntrain_op = tf.train.AdamOptimizer(LR).minimize(loss)\naccuracy = tf.metrics.accuracy(labels=tf.argmax(tf_y, axis=1), \n                               predictions=tf.argmax(output, axis=1))[1]\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("blockquote",[a("p",[t._v("Training")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("sess "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Session"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninit_op "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("group"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("global_variables_initializer"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                   tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("local_variables_initializer"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("init_op"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" step "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("range")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("600")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    b_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("train"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next_batch"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BATCH_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    _"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" loss_ "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" sess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("train_op"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" loss"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" b_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf_y"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" b_y"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" step "),a("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("50")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        accuracy_ "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" sess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("accuracy"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" test_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf_y"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" test_y"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'Step:'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" step"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'| train loss: %.4f'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v("\n              loss_"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'| test accuracy: %.2f'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v(" accuracy_"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("blockquote",[a("p",[t._v("Testing")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# print 10 predictions from test data")]),t._v("\ntest_output "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" sess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" test_x"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("10")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npred_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argmax"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_output"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pred_y"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'prediction number'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argmax"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_y"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("10")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'real number'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# test_y is one-hot encoded")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h2",{attrs:{id:"rnn-classification-mnist"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rnn-classification-mnist","aria-hidden":"true"}},[t._v("#")]),t._v(" RNN Classification (MNIST)")]),a("blockquote",[a("p",[t._v("Setup (skip, same as CNN)")])]),a("blockquote",[a("p",[t._v("Prepare Input")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# Hyper Parameters")]),t._v("\nBATCH_SIZE "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("64")]),t._v("\nTIME_STEP "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),t._v("          "),a("span",{attrs:{class:"token comment"}},[t._v("# rnn time step / image height")]),t._v("\nINPUT_SIZE "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),t._v("         "),a("span",{attrs:{class:"token comment"}},[t._v("# rnn input size / image width")]),t._v("\nLR "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0.01")]),t._v("               "),a("span",{attrs:{class:"token comment"}},[t._v("# learning rate")]),t._v("\n\nmnist "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" input_data"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read_data_sets"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'./mnist'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" one_hot"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("True")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest_x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("images"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("2000")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ntest_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("labels"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("2000")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# shape(batch, 784)")]),t._v("\ntf_x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TIME_STEP "),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" INPUT_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntf_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("int32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("10")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# (batch, height, width, channel)")]),t._v("\nimage "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TIME_STEP"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" INPUT_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br")])]),a("blockquote",[a("p",[t._v("RNN")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("rnn_cell "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LSTMCell"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("num_units"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token number"}},[t._v("64")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\noutputs"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("h_c"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" h_n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic_rnn"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                   "),a("span",{attrs:{class:"token comment"}},[t._v("# cell you have chosen")]),t._v("\n    image"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                      "),a("span",{attrs:{class:"token comment"}},[t._v("# input")]),t._v("\n    initial_state"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         "),a("span",{attrs:{class:"token comment"}},[t._v("# the initial hidden state")]),t._v("\n    dtype"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),a("span",{attrs:{class:"token comment"}},[t._v("# must given if set initial_state = None")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("# False: (batch, time step, input); True: (time step, batch, input)")]),t._v("\n    time_major"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("False")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# output based on the last output step")]),t._v("\noutput "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("outputs"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("10")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("blockquote",[a("p",[t._v("Loss / Training Ops (skip, same as CNN)")])]),a("blockquote",[a("p",[t._v("Training (skip, same as CNN)")])]),a("blockquote",[a("p",[t._v("Testing (skip, same as CNN)")])]),a("hr"),a("p",[a("strong",[t._v("[SideNote]")]),t._v(" Multi-layer RNN Cell")]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# create 2 LSTMCells")]),t._v("\nrnn_layers "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LSTMCell"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("128")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LSTMCell"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("256")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# create a RNN cell composed sequentially of a number of RNNCells")]),t._v("\nmulti_rnn_cell "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MultiRNNCell"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rnn_layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 'outputs' is a tensor of shape [batch_size, max_time, 256]")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 'state' is a N-tuple where N is the number of LSTMCells containing a")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# tf.contrib.rnn.LSTMStateTuple for each cell")]),t._v("\noutputs"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic_rnn"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cell"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("multi_rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                                   inputs"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("data"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                                   dtype"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("h2",{attrs:{id:"rnn-regression-seq-to-seq"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rnn-regression-seq-to-seq","aria-hidden":"true"}},[t._v("#")]),t._v(" RNN Regression (Seq-to-Seq)")]),a("blockquote",[a("p",[t._v("Setup")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" tensorflow "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" tf\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" numpy "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" np\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" matplotlib"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pyplot "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" plt\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("blockquote",[a("p",[t._v("Prepare Input")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("TIME_STEP "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("10")]),t._v("       "),a("span",{attrs:{class:"token comment"}},[t._v("# rnn time step")]),t._v("\nINPUT_SIZE "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v("      "),a("span",{attrs:{class:"token comment"}},[t._v("# rnn input size")]),t._v("\nCELL_SIZE "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("32")]),t._v("      "),a("span",{attrs:{class:"token comment"}},[t._v("# rnn cell size")]),t._v("\nLR "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0.02")]),t._v("           "),a("span",{attrs:{class:"token comment"}},[t._v("# learning rate")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# Generate sin wave as input and cos wave as target")]),t._v("\nsteps "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("linspace"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pi"),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("100")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dtype"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nx_np "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sin"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("steps"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ny_np "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cos"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("steps"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ntf_x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TIME_STEP"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" INPUT_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntf_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TIME_STEP"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" INPUT_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("blockquote",[a("p",[t._v("RNN")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("rnn_cell "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LSTMCell"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("num_units"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("CELL_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# very first hidden state")]),t._v("\ninit_s "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zero_state"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("batch_size"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dtype"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\noutputs"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_s "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic_rnn"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    rnn_cell"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                   "),a("span",{attrs:{class:"token comment"}},[t._v("# cell you have chosen")]),t._v("\n    tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                       "),a("span",{attrs:{class:"token comment"}},[t._v("# input")]),t._v("\n    initial_state"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("init_s"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),a("span",{attrs:{class:"token comment"}},[t._v("# the initial hidden state")]),t._v("\n   \n    "),a("span",{attrs:{class:"token comment"}},[t._v("# False: (batch, time step, input)")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("# True:  (time step, batch, input)")]),t._v("\n    time_major"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("False")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# reshape 3D output to 2D (flattened) for fully connected layer")]),t._v("\nouts2D "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("outputs"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CELL_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nnet_outs2D "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("outs2D"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" INPUT_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# reshape back to 3D")]),t._v("\nouts "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("net_outs2D"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TIME_STEP"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" INPUT_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br")])]),a("blockquote",[a("p",[t._v("Loss / Training Ops")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("loss "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("losses"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mean_squared_error"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("labels"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("tf_y"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" predictions"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("outs"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntrain_op "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("train"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AdamOptimizer"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LR"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("minimize"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("loss"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("blockquote",[a("p",[t._v("Training")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("sess "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Session"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("global_variables_initializer"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" step "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("range")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("160")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    start"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" step "),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pi"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("step"),a("span",{attrs:{class:"token operator"}},[t._v("+")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pi   "),a("span",{attrs:{class:"token comment"}},[t._v("# time range")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("# use sin predicts cos")]),t._v("\n    steps "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("linspace"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TIME_STEP"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("# shape (batch, time_step, input_size)")]),t._v("\n    x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sin"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("steps"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newaxis"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newaxis"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cos"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("steps"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newaxis"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newaxis"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    \n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'final_s_'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("globals")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# first state, no any hidden state")]),t._v("\n        feed_dict "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf_y"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" y"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("else")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                           "),a("span",{attrs:{class:"token comment"}},[t._v("# has hidden state, so pass it to rnn")]),t._v("\n        feed_dict "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf_y"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" y"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" init_s"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" final_s_"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    _"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pred_"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_s_ "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" sess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("train_op"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" outs"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_s"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" feed_dict"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("     "),a("span",{attrs:{class:"token comment"}},[t._v("# train")]),t._v("\n\n    "),a("span",{attrs:{class:"token comment"}},[t._v("# plotting")]),t._v("\n    plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plot"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("steps"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flatten"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'r-'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plot"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("steps"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pred_"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flatten"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'b-'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ylim"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1.2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1.2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("draw"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pause"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("0.05")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br")])]),a("h2",{attrs:{id:"autoencoder-mnist"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#autoencoder-mnist","aria-hidden":"true"}},[t._v("#")]),t._v(" AutoEncoder (MNIST)")]),a("blockquote",[a("p",[t._v("Setup (skip, same as CNN)")])]),a("blockquote",[a("p",[t._v("Prepare Input")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("BATCH_SIZE "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("64")]),t._v("\nLR "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0.002")]),t._v("  "),a("span",{attrs:{class:"token comment"}},[t._v("# learning rate")]),t._v("\nN_TEST_IMG "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("5")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# use not one-hotted target data")]),t._v("\nmnist "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" input_data"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read_data_sets"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'./mnist'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" one_hot"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("False")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest_x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("images"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("200")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ntest_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("labels"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("200")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\ntf_x "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("blockquote",[a("p",[t._v("Encoder")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("en0 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("128")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tanh"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nen1 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("en0"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("64")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tanh"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nen2 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("en1"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("12")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tanh"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nencoded "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("en2"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("blockquote",[a("p",[t._v("Decoder")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("de0 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("encoded"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("12")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tanh"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nde1 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("de0"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("64")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tanh"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nde2 "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("de1"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("128")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tanh"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndecoded "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dense"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("de2"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sigmoid"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("blockquote",[a("p",[t._v("Loss / Training Ops")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("loss "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("losses"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mean_squared_error"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("labels"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" predictions"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("decoded"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntrain "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("train"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AdamOptimizer"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LR"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("minimize"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("loss"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("blockquote",[a("p",[t._v("Setup subplots for visualizing training progress")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("f"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplots"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N_TEST_IMG"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" figsize"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("5")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ion"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),a("span",{attrs:{class:"token comment"}},[t._v("# continuous plotting")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# Plot first N test images during trainig")]),t._v("\ntest_data "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("images"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("N_TEST_IMG"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("range")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("N_TEST_IMG"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    a"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_data"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmap"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("'gray'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    a"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_xticks"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    a"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_yticks"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("blockquote",[a("p",[t._v("Training")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("sess "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Session"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tf"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("global_variables_initializer"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" step "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("range")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("8000")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    b_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b_y "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mnist"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("train"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next_batch"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BATCH_SIZE"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    _"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoded_"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" decoded_"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" loss_ "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" sess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("train"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoded"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" decoded"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" loss"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" b_x"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" step "),a("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("100")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# plotting")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'train loss: %.4f'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v(" loss_"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("# plotting decoded image (second row)")]),t._v("\n        decoded_data "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" sess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("decoded"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" test_data"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("range")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("N_TEST_IMG"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            a"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clear"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            a"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("np"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("decoded_data"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("28")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmap"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("'gray'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            a"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_xticks"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            a"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_yticks"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("draw"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pause"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("0.01")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ioff"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])]),a("p",[a("img",{attrs:{src:"/images/autoencoder-train-visualize.png",alt:"autoencoder-train-visualize.png"}})]),a("p",[a("em",[a("div",{staticClass:"caption"},[t._v(" First row is the original test images, second row is 'decoded' test images. ")])])]),a("blockquote",[a("p",[t._v("Test data 3D visualization")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" mpl_toolkits"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mplot3d "),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Axes3D\n"),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" matplotlib "),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" cm\n\nfig "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("figure"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Axes3D"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fig"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nX"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Y"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Z "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" encoded_data"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoded_data"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoded_data"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\ntest_data "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" test_x"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("200")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nencoded_data "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" sess"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("encoded"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tf_x"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" test_data"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" z"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" s "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("zip")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Y"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Z"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" test_y"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    c "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cm"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rainbow"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token builtin"}},[t._v("int")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("255")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("s"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token number"}},[t._v("9")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" z"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" s"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" backgroundcolor"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("c"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \nax"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_xlim"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token builtin"}},[t._v("min")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" X"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token builtin"}},[t._v("max")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_ylim"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Y"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token builtin"}},[t._v("min")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Y"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token builtin"}},[t._v("max")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_zlim"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Z"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token builtin"}},[t._v("min")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Z"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token builtin"}},[t._v("max")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("show"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("p",[a("img",{attrs:{src:"/images/autoencoder-3d-visualize.png",alt:"autoencoder-3d-visualize.png"}})]),a("p",[a("em",[a("div",{staticClass:"caption"},[t._v(" Visualize relationships between digits that encoder has learned. Use t-SNE for dimension reduction. ")])])])])}],!1,null,null,null);s.default=e.exports}}]);